<!DOCTYPE html>
<html lang="en">

<head>
        <meta charset="UTF-8">
        <title>
                <%= blog.Tittle %> - Blogify
        </title>
        <%- include("./parts/header") %>
</head>

<body class="bg-slate-950 text-white font-sans antialiased">
        <%- include("./parts/navbar") %>

                <% if (locals.user) { %>
                        <!-- Hero Image -->
                        <div class="relative h-[50vh] min-h-[400px]">
                                <img src="<%= blog.Coverimageurl %>" alt="<%= blog.Tittle %>"
                                        class="w-full h-full object-cover">
                                <div
                                        class="absolute inset-0 bg-gradient-to-t from-slate-900 via-slate-900/50 to-transparent">
                                </div>
                                <div
                                        class="absolute bottom-0 left-0 w-full p-6 md:p-12 bg-gradient-to-t from-slate-900 to-transparent">
                                        <div class="container mx-auto max-w-4xl animate-slide-up">
                                                <h1
                                                        class="text-4xl md:text-6xl font-bold mb-4 leading-tight shadow-black drop-shadow-lg">
                                                        <%= blog.Tittle %>
                                                </h1>
                                                <div class="flex items-center gap-4 text-slate-300">
                                                        <div
                                                                class="flex items-center gap-2 bg-black/30 backdrop-blur-md px-4 py-2 rounded-full border border-white/10 hover:bg-white/10 transition-colors cursor-pointer group">
                                                                <img src="<%= blog.Createdby.profileImage || `https://ui-avatars.com/api/?name=${blog.Createdby.fullname}` %>"
                                                                        class="w-8 h-8 rounded-full border border-blue-500/50 group-hover:border-blue-400 transition-colors"
                                                                        alt="">
                                                                <span class="font-medium group-hover:text-white">
                                                                        <%= blog.Createdby.fullname %>
                                                                </span>
                                                        </div>
                                                        <% if(blog.createdAt) { %>
                                                                <span class="text-sm border-l border-white/20 pl-4">
                                                                        <%= new Date(blog.createdAt).toLocaleDateString('en-US',
                                                                                { year: 'numeric' , month: 'long' ,
                                                                                day: 'numeric' }) %>
                                                                </span>
                                                                <% } %>
                                                </div>
                                        </div>
                                </div>
                        </div>

                        <!-- Content -->
                        <div class="container mx-auto px-6 max-w-4xl -mt-10 relative z-10">
                                <div class="glass-card p-8 md:p-12 mb-12 animate-fade-in">
                                        <div
                                                class="prose prose-lg prose-invert max-w-none prose-headings:font-display prose-a:text-blue-400 hover:prose-a:text-blue-300 prose-img:rounded-xl">
                                                <pre
                                                        class="whitespace-pre-wrap font-sans text-slate-300 leading-relaxed"><%= blog.body %></pre>
                                        </div>
                                </div>

                                <!-- Comments Section -->
                                <div class="max-w-3xl mx-auto">
                                        <h3 class="text-2xl font-bold mb-8 flex items-center gap-2">
                                                <span>ðŸ’¬</span> Comments <span
                                                        class="text-slate-500 text-lg font-normal">(<%= comments.length
                                                                %>)</span>
                                        </h3>

                                        <!-- Comment Form -->
                                        <div
                                                class="glass-card p-6 mb-10 transform transition-all duration-300 hover:shadow-blue-500/10 hover:shadow-xl">
                                                <form action="/Blog/comment/<%=blog._id%>" method="post"
                                                        class="flex flex-col md:flex-row gap-4 items-start">
                                                        <img src="<%= locals.user.profileImage || `https://ui-avatars.com/api/?name=${locals.user.fullname}` %>"
                                                                class="w-10 h-10 rounded-full border border-blue-500/30 hidden md:block"
                                                                alt="">
                                                        <div class="flex-1 w-full">
                                                                <input type="text" class="input-field mb-3"
                                                                        name="content"
                                                                        placeholder="Share your thoughts..." required>
                                                                <div class="flex justify-end">
                                                                        <button class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium transition-colors text-sm flex items-center gap-2"
                                                                                type="submit">
                                                                                Post Comment ðŸš€
                                                                        </button>
                                                                </div>
                                                        </div>
                                                </form>
                                        </div>

                                        <!-- Comments List -->
                                        <div class="space-y-6 pb-20">
                                                <% comments.forEach(comment=> { %>
                                                        <div
                                                                class="glass-card p-5 flex gap-4 animate-slide-up group hover:bg-white/5 transition-colors">
                                                                <img src="<%= comment.createdBy ? (comment.createdBy.profileImage || `https://ui-avatars.com/api/?name=${comment.createdBy.fullname}`) : `https://ui-avatars.com/api/?name=User` %>"
                                                                        class="w-10 h-10 rounded-full border border-slate-700 mt-1 object-cover"
                                                                        alt="">
                                                                <div class="flex-1">
                                                                        <div
                                                                                class="flex items-center justify-between mb-2">
                                                                                <h5 class="font-bold text-slate-200">
                                                                                        <%= comment.createdBy ?
                                                                                                comment.createdBy.fullname
                                                                                                : 'Anonymous' %>
                                                                                </h5>
                                                                                <span class="text-xs text-slate-500">
                                                                                        <%= comment.createdAt ? new
                                                                                                Date(comment.createdAt).toLocaleDateString()
                                                                                                : 'Just now' %>
                                                                                </span>
                                                                        </div>
                                                                        <p
                                                                                class="text-slate-400 group-hover:text-slate-300 transition-colors">
                                                                                <%= comment.content %>
                                                                        </p>
                                                                </div>
                                                        </div>
                                                        <% }) %>
                                        </div>
                                </div>
                        </div>
                        <% } %>

                                <%- include("./parts/script") %>
</body>

</html>